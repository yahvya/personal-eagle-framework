\hypertarget{a00371_source}{}\doxysection{Default\+Maintenance\+Controller.\+php}
\label{a00371_source}\index{DefaultMaintenanceController.php@{DefaultMaintenanceController.php}}
\mbox{\hyperlink{a00371}{Aller à la documentation de ce fichier.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{a00371_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{a00371_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00003}00003\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{a00435}{Controllers}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00005}00005\ use\ Override;}
\DoxyCodeLine{\Hypertarget{a00371_source_l00006}00006\ use\ \mbox{\hyperlink{a00592}{SaboCore\(\backslash\)Controller\(\backslash\)MaintenanceController}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00007}00007\ use\ \mbox{\hyperlink{a00792}{SaboCore\(\backslash\)Routing\(\backslash\)Request\(\backslash\)Request}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00008}00008\ use\ \mbox{\hyperlink{a00796}{SaboCore\(\backslash\)Routing\(\backslash\)Response\(\backslash\)BladeResponse}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00009}00009\ use\ \mbox{\hyperlink{a00820}{SaboCore\(\backslash\)Routing\(\backslash\)Response\(\backslash\)Response}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00010}00010\ use\ \mbox{\hyperlink{a00860}{SaboCore\(\backslash\)Utils\(\backslash\)FileManager\(\backslash\)FileManager}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00011}00011\ use\ \mbox{\hyperlink{a00904}{SaboCore\(\backslash\)Utils\(\backslash\)Storage\(\backslash\)AppStorage}};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00012}00012\ use\ Throwable;}
\DoxyCodeLine{\Hypertarget{a00371_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00017}\mbox{\hyperlink{a00928}{00017}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{a00928}{DefaultMaintenanceController}}\ \textcolor{keyword}{extends}\ \mbox{\hyperlink{a00592}{MaintenanceController}}\{}
\DoxyCodeLine{\Hypertarget{a00371_source_l00018}00018\ \textcolor{preprocessor}{\ \ \ \ \#[Override]}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00019}\mbox{\hyperlink{a00928_a4f434104446da9c32fe3cbd24f2e1d75}{00019}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{a00928_a4f434104446da9c32fe3cbd24f2e1d75}{showMaintenancePage}}(\textcolor{keywordtype}{string}\ \$secretLink):\ \mbox{\hyperlink{a00820}{Response}}\{}
\DoxyCodeLine{\Hypertarget{a00371_source_l00020}00020\ \ \ \ \ \ \ \ \ return\ new\ \mbox{\hyperlink{a00796}{BladeResponse}}(}
\DoxyCodeLine{\Hypertarget{a00371_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ pathFromViews:\ \textcolor{stringliteral}{"{}maintenance/authentication"{}},}
\DoxyCodeLine{\Hypertarget{a00371_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ datas:\ [}
\DoxyCodeLine{\Hypertarget{a00371_source_l00023}00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}secretLink"{}}\ =>\ \$secretLink}
\DoxyCodeLine{\Hypertarget{a00371_source_l00024}00024\ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{a00371_source_l00025}00025\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{a00371_source_l00026}00026\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00028}00028\ \textcolor{preprocessor}{\ \ \ \ \#[Override]}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00029}\mbox{\hyperlink{a00928_af18de10cc83da13fac94c60a13fe0c1a}{00029}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{a00928_af18de10cc83da13fac94c60a13fe0c1a}{verifyLogin}}(\mbox{\hyperlink{a00792}{Request}}\ \$request):\ bool\{}
\DoxyCodeLine{\Hypertarget{a00371_source_l00030}00030\ \ \ \ \ \ \ \ \ try\{}
\DoxyCodeLine{\Hypertarget{a00371_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{stringliteral}{"{}csrf"{}}\ =>\ \$csrf,\textcolor{stringliteral}{"{}password"{}}\ =>\ \$password]\ =\ \$request-\/>getPostValues(}
\DoxyCodeLine{\Hypertarget{a00371_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Accès\ non\ autorisé"{}},}
\DoxyCodeLine{\Hypertarget{a00371_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}csrf"{}},\textcolor{stringliteral}{"{}password"{}}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{a00371_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ vérification\ csrf}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{a00362_a8be53ae6480c0f3c2133084a111bfe6b}{checkCsrf}}(token:\ \$csrf)\ )\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \$fileManager\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{a00860}{FileManager}}(fileAbsolutePath:\ AppStorage::buildStorageCompletePath(pathFromStorage:\ \textcolor{stringliteral}{"{}/maintenance/maintenance.secret"{}})\ );}
\DoxyCodeLine{\Hypertarget{a00371_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{a00371_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ vérification\ du\ mot\ de\ passe\ à\ partir\ de\ la\ clé\ secrète\ de\ maintenance}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ @password\_verify(password:\ \$password,hash:\ \$fileManager-\/>getFromStorage()-\/>getContent());}
\DoxyCodeLine{\Hypertarget{a00371_source_l00043}00043\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}(Throwable)\{}
\DoxyCodeLine{\Hypertarget{a00371_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{a00371_source_l00046}00046\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00047}00047\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00371_source_l00048}00048\ \}}

\end{DoxyCode}
